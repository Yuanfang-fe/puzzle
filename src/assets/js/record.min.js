var rrweb = function (e) {
  "use strict";
var t, n = function () { return (n = Object.assign || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var o in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]); return e }).apply(this, arguments) }; function r(e) { var t = "function" == typeof Symbol && Symbol.iterator, n = t && e[t], r = 0; if (n) return n.call(e); if (e && "number" == typeof e.length) return { next: function () { return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e } } }; throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.") } function o(e, t) { var n = "function" == typeof Symbol && e[Symbol.iterator]; if (!n) return e; var r, o, i = n.call(e), a = []; try { for (; (void 0 === t || t-- > 0) && !(r = i.next()).done;)a.push(r.value) } catch (e) { o = { error: e } } finally { try { r && !r.done && (n = i.return) && n.call(i) } finally { if (o) throw o.error } } return a } function i() { for (var e = [], t = 0; t < arguments.length; t++)e = e.concat(o(arguments[t])); return e } !function (e) { e[e.Document = 0] = "Document", e[e.DocumentType = 1] = "DocumentType", e[e.Element = 2] = "Element", e[e.Text = 3] = "Text", e[e.CDATA = 4] = "CDATA", e[e.Comment = 5] = "Comment" }(t || (t = {})); var a = 1, s = RegExp("[^a-z1-6-_]"); function c(e) { try { var t = e.rules || e.cssRules; return t ? Array.from(t).map(l).join("") : null } catch (e) { return null } } function l(e) { return function (e) { return "styleSheet" in e }(e) ? c(e.styleSheet) || "" : e.cssText } var u = /url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm, d = /^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/).*/, p = /^(data:)([\w\/\+\-]+);(charset=[\w-]+|base64|utf-?8).*,(.*)/i; function f(e, t) { return (e || "").replace(u, (function (e, n, r, o, i, a) { var s, c = r || i || a, l = n || o || ""; if (!c) return e; if (!d.test(c)) return "url(" + l + c + l + ")"; if (p.test(c)) return "url(" + l + c + l + ")"; if ("/" === c[0]) return "url(" + l + (((s = t).indexOf("//") > -1 ? s.split("/").slice(0, 3).join("/") : s.split("/")[0]).split("?")[0] + c) + l + ")"; var u = t.split("/"), f = c.split("/"); u.pop(); for (var h = 0, v = f; h < v.length; h++) { var m = v[h]; "." !== m && (".." === m ? u.pop() : u.push(m)) } return "url(" + l + u.join("/") + l + ")" })) } function h(e, t) { if (!t || "" === t.trim()) return t; var n = e.createElement("a"); return n.href = t, n.href } function v(e, t, n) { return "src" === t || "href" === t && n ? h(e, n) : "srcset" === t && n ? function (e, t) { return "" === t.trim() ? t : t.split(",").map((function (t) { var n = t.trimLeft().trimRight().split(" "); return 2 === n.length ? h(e, n[0]) + " " + n[1] : 1 === n.length ? "" + h(e, n[0]) : "" })).join(", ") }(e, n) : "style" === t && n ? f(n, location.href) : n } function m(e, n, r, o, i, a, l) { switch (void 0 === a && (a = {}), e.nodeType) { case e.DOCUMENT_NODE: return { type: t.Document, childNodes: [] }; case e.DOCUMENT_TYPE_NODE: return { type: t.DocumentType, name: e.name, publicId: e.publicId, systemId: e.systemId }; case e.ELEMENT_NODE: for (var u = function (e, t, n) { if ("string" == typeof t) { if (e.classList.contains(t)) return !0 } else e.classList.forEach((function (e) { if (t.test(e)) return !0 })); return !!n && e.matches(n) }(e, r, o), d = function (e) { var t = e.toLowerCase().trim(); return s.test(t) ? "div" : t }(e.tagName), p = {}, h = 0, m = Array.from(e.attributes); h < m.length; h++) { var y = m[h], g = y.name, b = y.value; p[g] = v(n, g, b) } if ("link" === d && i) { var S, E = Array.from(n.styleSheets).find((function (t) { return t.href === e.href })); (S = c(E)) && (delete p.rel, delete p.href, p._cssText = f(S, E.href)) } if ("style" === d && e.sheet && !(e.innerText || e.textContent || "").trim().length) (S = c(e.sheet)) && (p._cssText = f(S, location.href)); if ("input" === d || "textarea" === d || "select" === d) { b = e.value; "radio" !== p.type && "checkbox" !== p.type && "submit" !== p.type && "button" !== p.type && b ? p.value = a[p.type] || a[d] ? "*".repeat(b.length) : b : e.checked && (p.checked = e.checked) } if ("option" === d) { var w = e.parentElement; p.value === w.value && (p.selected = e.selected) } if ("canvas" === d && l && (p.rr_dataURL = e.toDataURL()), "audio" !== d && "video" !== d || (p.rr_mediaState = e.paused ? "paused" : "played"), e.scrollLeft && (p.rr_scrollLeft = e.scrollLeft), e.scrollTop && (p.rr_scrollTop = e.scrollTop), u) { var x = e.getBoundingClientRect(), T = x.width, I = x.height; p.rr_width = T + "px", p.rr_height = I + "px" } return { type: t.Element, tagName: d, attributes: p, childNodes: [], isSVG: (_ = e, "svg" === _.tagName || _ instanceof SVGElement || void 0), needBlock: u }; case e.TEXT_NODE: var C = e.parentNode && e.parentNode.tagName, M = e.textContent, N = "STYLE" === C || void 0; return N && M && (M = f(M, location.href)), "SCRIPT" === C && (M = "SCRIPT_PLACEHOLDER"), { type: t.Text, textContent: M || "", isStyle: N }; case e.CDATA_SECTION_NODE: return { type: t.CDATA, textContent: "" }; case e.COMMENT_NODE: return { type: t.Comment, textContent: e.textContent || "" }; default: return !1 }var _ } function y(e) { return void 0 === e ? "" : e.toLowerCase() } function g(e, n, r, o, i, s, c, l, u, d, p) { void 0 === s && (s = !1), void 0 === c && (c = !0), void 0 === u && (u = {}), void 0 === p && (p = !0); var f, h = m(e, n, o, i, c, l, d || !1); if (!h) return console.warn(e, "not serialized"), null; f = "__sn" in e ? e.__sn.id : !function (e, n) { if (n.comment && e.type === t.Comment) return !0; if (e.type === t.Element) { if (n.script && ("script" === e.tagName || "link" === e.tagName && "preload" === e.attributes.rel && "script" === e.attributes.as)) return !0; if (n.headFavicon && ("link" === e.tagName && "shortcut icon" === e.attributes.rel || "meta" === e.tagName && (y(e.attributes.name).match(/^msapplication-tile(image|color)$/) || "application-name" === y(e.attributes.name) || "icon" === y(e.attributes.rel) || "apple-touch-icon" === y(e.attributes.rel) || "shortcut icon" === y(e.attributes.rel)))) return !0; if ("meta" === e.tagName) { if (n.headMetaDescKeywords && y(e.attributes.name).match(/^description|keywords$/)) return !0; if (n.headMetaSocial && (y(e.attributes.property).match(/^(og|twitter|fb):/) || y(e.attributes.name).match(/^(og|twitter):/) || "pinterest" === y(e.attributes.name))) return !0; if (n.headMetaRobots && ("robots" === y(e.attributes.name) || "googlebot" === y(e.attributes.name) || "bingbot" === y(e.attributes.name))) return !0; if (n.headMetaHttpEquiv && void 0 !== e.attributes["http-equiv"]) return !0; if (n.headMetaAuthorship && ("author" === y(e.attributes.name) || "generator" === y(e.attributes.name) || "framework" === y(e.attributes.name) || "publisher" === y(e.attributes.name) || "progid" === y(e.attributes.name) || y(e.attributes.property).match(/^article:/) || y(e.attributes.property).match(/^product:/))) return !0; if (n.headMetaVerification && ("google-site-verification" === y(e.attributes.name) || "yandex-verification" === y(e.attributes.name) || "csrf-token" === y(e.attributes.name) || "p:domain_verify" === y(e.attributes.name) || "verify-v1" === y(e.attributes.name) || "verification" === y(e.attributes.name) || "shopify-checkout-api-token" === y(e.attributes.name))) return !0 } } return !1 }(h, u) && (p || h.type !== t.Text || h.isStyle || h.textContent.replace(/^\s+|\s+$/gm, "").length) ? a++ : -2; var v = Object.assign(h, { id: f }); if (e.__sn = v, -2 === f) return null; r[f] = e; var b = !s; if (v.type === t.Element && (b = b && !v.needBlock, delete v.needBlock), (v.type === t.Document || v.type === t.Element) && b) { u.headWhitespace && h.type === t.Element && "head" == h.tagName && (p = !1); for (var S = 0, E = Array.from(e.childNodes); S < E.length; S++) { var w = g(E[S], n, r, o, i, s, c, l, u, d, p); w && v.childNodes.push(w) } } return v } var b = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g; function S(e, t) { void 0 === t && (t = {}); var n = 1, r = 1; function o(e) { var t = e.match(/\n/g); t && (n += t.length); var o = e.lastIndexOf("\n"); r = -1 === o ? r + e.length : e.length - o } function i() { var e = { line: n, column: r }; return function (t) { return t.position = new a(e), f(), t } } var a = function (e) { this.start = e, this.end = { line: n, column: r }, this.source = t.source }; a.prototype.content = e; var s = []; function c(o) { var i = new Error(t.source + ":" + n + ":" + r + ": " + o); if (i.reason = o, i.filename = t.source, i.line = n, i.column = r, i.source = e, !t.silent) throw i; s.push(i) } function l() { return p(/^{\s*/) } function u() { return p(/^}/) } function d() { var t, n = []; for (f(), h(n); e.length && "}" !== e.charAt(0) && (t = M() || N());)!1 !== t && (n.push(t), h(n)); return n } function p(t) { var n = t.exec(e); if (n) { var r = n[0]; return o(r), e = e.slice(r.length), n } } function f() { p(/^\s*/) } function h(e) { var t; for (void 0 === e && (e = []); t = v();)!1 !== t && e.push(t), t = v(); return e } function v() { var t = i(); if ("/" === e.charAt(0) && "*" === e.charAt(1)) { for (var n = 2; "" !== e.charAt(n) && ("*" !== e.charAt(n) || "/" !== e.charAt(n + 1));)++n; if (n += 2, "" === e.charAt(n - 1)) return c("End of comment missing"); var a = e.slice(2, n - 2); return r += 2, o(a), e = e.slice(n), r += 2, t({ type: "comment", comment: a }) } } function m() { var e = p(/^([^{]+)/); if (e) return E(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, "").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, (function (e) { return e.replace(/,/g, "â€Œ") })).split(/\s*(?![^(]*\)),\s*/).map((function (e) { return e.replace(/\u200C/g, ",") })) } function y() { var e = i(), t = p(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/); if (t) { var n = E(t[0]); if (!p(/^:\s*/)) return c("property missing ':'"); var r = p(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/), o = e({ type: "declaration", property: n.replace(b, ""), value: r ? E(r[0]).replace(b, "") : "" }); return p(/^[;\s]*/), o } } function g() { var e, t = []; if (!l()) return c("missing '{'"); for (h(t); e = y();)!1 !== e && (t.push(e), h(t)), e = y(); return u() ? t : c("missing '}'") } function S() { for (var e, t = [], n = i(); e = p(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]), p(/^,\s*/); if (t.length) return n({ type: "keyframe", values: t, declarations: g() }) } var w, x = C("import"), T = C("charset"), I = C("namespace"); function C(e) { var t = new RegExp("^@" + e + "\\s*([^;]+);"); return function () { var n = i(), r = p(t); if (r) { var o = { type: e }; return o[e] = r[1].trim(), n(o) } } } function M() { if ("@" === e[0]) return function () { var e = i(), t = p(/^@([-\w]+)?keyframes\s*/); if (t) { var n = t[1]; if (!(t = p(/^([-\w]+)\s*/))) return c("@keyframes missing name"); var r, o = t[1]; if (!l()) return c("@keyframes missing '{'"); for (var a = h(); r = S();)a.push(r), a = a.concat(h()); return u() ? e({ type: "keyframes", name: o, vendor: n, keyframes: a }) : c("@keyframes missing '}'") } }() || function () { var e = i(), t = p(/^@media *([^{]+)/); if (t) { var n = E(t[1]); if (!l()) return c("@media missing '{'"); var r = h().concat(d()); return u() ? e({ type: "media", media: n, rules: r }) : c("@media missing '}'") } }() || function () { var e = i(), t = p(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/); if (t) return e({ type: "custom-media", name: E(t[1]), media: E(t[2]) }) }() || function () { var e = i(), t = p(/^@supports *([^{]+)/); if (t) { var n = E(t[1]); if (!l()) return c("@supports missing '{'"); var r = h().concat(d()); return u() ? e({ type: "supports", supports: n, rules: r }) : c("@supports missing '}'") } }() || x() || T() || I() || function () { var e = i(), t = p(/^@([-\w]+)?document *([^{]+)/); if (t) { var n = E(t[1]), r = E(t[2]); if (!l()) return c("@document missing '{'"); var o = h().concat(d()); return u() ? e({ type: "document", document: r, vendor: n, rules: o }) : c("@document missing '}'") } }() || function () { var e = i(); if (p(/^@page */)) { var t = m() || []; if (!l()) return c("@page missing '{'"); for (var n, r = h(); n = y();)r.push(n), r = r.concat(h()); return u() ? e({ type: "page", selectors: t, declarations: r }) : c("@page missing '}'") } }() || function () { var e = i(); if (p(/^@host\s*/)) { if (!l()) return c("@host missing '{'"); var t = h().concat(d()); return u() ? e({ type: "host", rules: t }) : c("@host missing '}'") } }() || function () { var e = i(); if (p(/^@font-face\s*/)) { if (!l()) return c("@font-face missing '{'"); for (var t, n = h(); t = y();)n.push(t), n = n.concat(h()); return u() ? e({ type: "font-face", declarations: n }) : c("@font-face missing '}'") } }() } function N() { var e = i(), t = m(); return t ? (h(), e({ type: "rule", selectors: t, declarations: g() })) : c("selector missing") } return function e(t, n) { for (var r = t && "string" == typeof t.type, o = r ? t : n, i = 0, a = Object.keys(t); i < a.length; i++) { var s = a[i], c = t[s]; Array.isArray(c) ? c.forEach((function (t) { e(t, o) })) : c && "object" == typeof c && e(c, o) } r && Object.defineProperty(t, "parent", { configurable: !0, writable: !0, enumerable: !1, value: n || null }); return t }((w = d(), { type: "stylesheet", stylesheet: { source: t.source, rules: w, parsingErrors: s } })) } function E(e) { return e ? e.replace(/^\s+|\s+$/g, "") : "" } var w = { script: "noscript", altglyph: "altGlyph", altglyphdef: "altGlyphDef", altglyphitem: "altGlyphItem", animatecolor: "animateColor", animatemotion: "animateMotion", animatetransform: "animateTransform", clippath: "clipPath", feblend: "feBlend", fecolormatrix: "feColorMatrix", fecomponenttransfer: "feComponentTransfer", fecomposite: "feComposite", feconvolvematrix: "feConvolveMatrix", fediffuselighting: "feDiffuseLighting", fedisplacementmap: "feDisplacementMap", fedistantlight: "feDistantLight", fedropshadow: "feDropShadow", feflood: "feFlood", fefunca: "feFuncA", fefuncb: "feFuncB", fefuncg: "feFuncG", fefuncr: "feFuncR", fegaussianblur: "feGaussianBlur", feimage: "feImage", femerge: "feMerge", femergenode: "feMergeNode", femorphology: "feMorphology", feoffset: "feOffset", fepointlight: "fePointLight", fespecularlighting: "feSpecularLighting", fespotlight: "feSpotLight", fetile: "feTile", feturbulence: "feTurbulence", foreignobject: "foreignObject", glyphref: "glyphRef", lineargradient: "linearGradient", radialgradient: "radialGradient" }; var x, T, I, C, M, N = /([^\\]):hover/g; function _(e) { var t = S(e, { silent: !0 }); return t.stylesheet ? (t.stylesheet.rules.forEach((function (t) { "selectors" in t && (t.selectors || []).forEach((function (t) { if (N.test(t)) { var n = t.replace(N, "$1.\\:hover"); e = e.replace(t, t + ", " + n) } })) })), e) : e } function k(e, n, r) { switch (e.type) { case t.Document: return n.implementation.createDocument(null, "", null); case t.DocumentType: return n.implementation.createDocumentType(e.name || "html", e.publicId, e.systemId); case t.Element: var o, i = function (e) { var t = w[e.tagName] ? w[e.tagName] : e.tagName; return "link" === t && e.attributes._cssText && (t = "style"), t }(e); o = e.isSVG ? n.createElementNS("http://www.w3.org/2000/svg", i) : n.createElement(i); var a = function (t) { if (!e.attributes.hasOwnProperty(t)) return "continue"; var a = e.attributes[t]; if (a = "boolean" == typeof a || "number" == typeof a ? "" : a, t.startsWith("rr_")) { if ("canvas" === i && "rr_dataURL" === t) { var s = document.createElement("img"); s.src = a, s.onload = function () { var e = o.getContext("2d"); e && e.drawImage(s, 0, 0, s.width, s.height) } } if ("rr_width" === t && (o.style.width = a), "rr_height" === t && (o.style.height = a), "rr_mediaState" === t) switch (a) { case "played": o.play(); case "paused": o.pause() } } else { var c = "textarea" === i && "value" === t, l = "style" === i && "_cssText" === t; if (l && r && (a = _(a)), c || l) { for (var u = n.createTextNode(a), d = 0, p = Array.from(o.childNodes); d < p.length; d++) { var f = p[d]; f.nodeType === o.TEXT_NODE && o.removeChild(f) } return o.appendChild(u), "continue" } if ("iframe" === i && "src" === t) return "continue"; try { e.isSVG && "xlink:href" === t ? o.setAttributeNS("http://www.w3.org/1999/xlink", t, a) : "onload" === t || "onclick" === t || "onmouse" === t.substring(0, 7) ? o.setAttribute("_" + t, a) : o.setAttribute(t, a) } catch (e) { } } }; for (var s in e.attributes) a(s); return o; case t.Text: return n.createTextNode(e.isStyle && r ? _(e.textContent) : e.textContent); case t.CDATA: return n.createCDATASection(e.textContent); case t.Comment: return n.createComment(e.textContent); default: return null } } function R(e, n, r, o, i) { void 0 === o && (o = !1), void 0 === i && (i = !0); var a = k(e, n, i); if (!a) return null; if (e.type === t.Document && (n.close(), n.open(), a = n), a.__sn = e, r[e.id] = a, (e.type === t.Document || e.type === t.Element) && !o) for (var s = 0, c = e.childNodes; s < c.length; s++) { var l = c[s], u = R(l, n, r, !1, i); u ? a.appendChild(u) : console.warn("Failed to rebuild", l) } return a } function O(e, n, r, o) { void 0 === o && (o = !0); var i = {}, a = R(e, n, i, !1, o); return function (e, t) { for (var n in e) e[n] && (r = e[n], t(r)); var r }(i, (function (e) { r && r(e), function (e) { var n = e.__sn; if (n.type === t.Element) { var r = e; for (var o in n.attributes) if (n.attributes.hasOwnProperty(o) && o.startsWith("rr_")) { var i = n.attributes[o]; "rr_scrollLeft" === o && (r.scrollLeft = i), "rr_scrollTop" === o && (r.scrollTop = i) } } }(e) })), [a, i] } function A(e, t, n) { void 0 === n && (n = document); var r = { capture: !0, passive: !0 }; return n.addEventListener(e, t, r), function () { return n.removeEventListener(e, t, r) } } (x = e.EventType || (e.EventType = {}))[x.DomContentLoaded = 0] = "DomContentLoaded", x[x.Load = 1] = "Load", x[x.FullSnapshot = 2] = "FullSnapshot", x[x.IncrementalSnapshot = 3] = "IncrementalSnapshot", x[x.Meta = 4] = "Meta", x[x.Custom = 5] = "Custom", (T = e.IncrementalSource || (e.IncrementalSource = {}))[T.Mutation = 0] = "Mutation", T[T.MouseMove = 1] = "MouseMove", T[T.MouseInteraction = 2] = "MouseInteraction", T[T.Scroll = 3] = "Scroll", T[T.ViewportResize = 4] = "ViewportResize", T[T.Input = 5] = "Input", T[T.TouchMove = 6] = "TouchMove", T[T.MediaInteraction = 7] = "MediaInteraction", T[T.StyleSheetRule = 8] = "StyleSheetRule", T[T.CanvasMutation = 9] = "CanvasMutation", T[T.Font = 10] = "Font", (I = e.MouseInteractions || (e.MouseInteractions = {}))[I.MouseUp = 0] = "MouseUp", I[I.MouseDown = 1] = "MouseDown", I[I.Click = 2] = "Click", I[I.ContextMenu = 3] = "ContextMenu", I[I.DblClick = 4] = "DblClick", I[I.Focus = 5] = "Focus", I[I.Blur = 6] = "Blur", I[I.TouchStart = 7] = "TouchStart", I[I.TouchMove_Departed = 8] = "TouchMove_Departed", I[I.TouchEnd = 9] = "TouchEnd", function (e) { e[e.Play = 0] = "Play", e[e.Pause = 1] = "Pause" }(C || (C = {})), (M = e.ReplayerEvents || (e.ReplayerEvents = {})).Start = "start", M.Pause = "pause", M.Resume = "resume", M.Resize = "resize", M.Finish = "finish", M.FullsnapshotRebuilded = "fullsnapshot-rebuilded", M.LoadStylesheetStart = "load-stylesheet-start", M.LoadStylesheetEnd = "load-stylesheet-end", M.SkipStart = "skip-start", M.SkipEnd = "skip-end", M.MouseInteraction = "mouse-interaction", M.EventCast = "event-cast", M.CustomEvent = "custom-event", M.Flush = "flush", M.StateChange = "state-change"; var D = { map: {}, getId: function (e) { return e.__sn ? e.__sn.id : -1 }, getNode: function (e) { return D.map[e] || null }, removeNodeFromMap: function (e) { var t = e.__sn && e.__sn.id; delete D.map[t], e.childNodes && e.childNodes.forEach((function (e) { return D.removeNodeFromMap(e) })) }, has: function (e) { return D.map.hasOwnProperty(e) } }; function L(e, t, n) { void 0 === n && (n = {}); var r = null, o = 0; return function (i) { var a = Date.now(); o || !1 !== n.leading || (o = a); var s = t - (a - o), c = this, l = arguments; s <= 0 || s > t ? (r && (window.clearTimeout(r), r = null), o = a, e.apply(c, l)) : r || !1 === n.trailing || (r = window.setTimeout((function () { o = !1 === n.leading ? 0 : Date.now(), r = null, e.apply(c, l) }), s)) } } function F(e, t, n, r, o) { void 0 === o && (o = window); var i = o.Object.getOwnPropertyDescriptor(e, t); return o.Object.defineProperty(e, t, r ? n : { set: function (e) { var t = this; setTimeout((function () { n.set.call(t, e) }), 0), i && i.set && i.set.call(this, e) } }), function () { return F(e, t, i || {}, !0) } } function P(e, t, n) { try { if (!(t in e)) return function () { }; var r = e[t], o = n(r); return "function" == typeof o && (o.prototype = o.prototype || {}, Object.defineProperties(o, { __rrweb_original__: { enumerable: !1, value: r } })), e[t] = o, function () { e[t] = r } } catch (e) { return function () { } } } function z() { return window.innerHeight || document.documentElement && document.documentElement.clientHeight || document.body && document.body.clientHeight } function j() { return window.innerWidth || document.documentElement && document.documentElement.clientWidth || document.body && document.body.clientWidth } function V(e, t) { if (!e) return !1; if (e.nodeType === e.ELEMENT_NODE) { var n = !1; return "string" == typeof t ? n = e.classList.contains(t) : e.classList.forEach((function (e) { t.test(e) && (n = !0) })), n || V(e.parentNode, t) } return e.nodeType, e.TEXT_NODE, V(e.parentNode, t) } function U(e) { var t = D.getId(e); return !D.has(t) || (!e.parentNode || e.parentNode.nodeType !== e.DOCUMENT_NODE) && (!e.parentNode || U(e.parentNode)) } function W(e) { return Boolean(e.changedTouches) } function B(e) { void 0 === e && (e = window), "NodeList" in e && !e.NodeList.prototype.forEach && (e.NodeList.prototype.forEach = Array.prototype.forEach), "DOMTokenList" in e && !e.DOMTokenList.prototype.forEach && (e.DOMTokenList.prototype.forEach = Array.prototype.forEach) } function H(t) { switch (t.type) { case e.EventType.DomContentLoaded: case e.EventType.Load: case e.EventType.Custom: return !1; case e.EventType.FullSnapshot: case e.EventType.Meta: return !0 }switch (t.data.source) { case e.IncrementalSource.MouseMove: case e.IncrementalSource.MouseInteraction: case e.IncrementalSource.TouchMove: case e.IncrementalSource.MediaInteraction: return !1; case e.IncrementalSource.ViewportResize: case e.IncrementalSource.StyleSheetRule: case e.IncrementalSource.Scroll: case e.IncrementalSource.Input: return !0 }return !0 } var X = function () { function t() { this.reset() } return t.prototype.add = function (e) { var t = this.indexes.get(e.parentId), n = { id: e.node.id, mutation: e, children: [], texts: [], attributes: [] }; t ? (n.parent = t, t.children[n.id] = n) : this.tree[n.id] = n, this.indexes.set(n.id, n) }, t.prototype.remove = function (e) { var t = this, n = this.indexes.get(e.parentId), r = this.indexes.get(e.id), o = function (e) { t.removeIdSet.add(e); var n = D.getNode(e); null == n || n.childNodes.forEach((function (e) { "__sn" in e && o(e.__sn.id) })) }, i = function (n) { t.removeIdSet.add(n.id), Object.values(n.children).forEach((function (e) { return i(e) })); var r = t.indexes.get(n.id); if (r) { var o = r.parent; o && (delete r.parent, delete o.children[r.id], t.indexes.delete(e.id)) } }; r ? n ? (delete r.parent, delete n.children[r.id], this.indexes.delete(e.id), i(r)) : (delete this.tree[r.id], this.indexes.delete(r.id), i(r)) : (this.removeNodeMutations.push(e), o(e.id)) }, t.prototype.text = function (e) { var t = this.indexes.get(e.id); t ? t.texts.push(e) : this.textMutations.push(e) }, t.prototype.attribute = function (e) { var t = this.indexes.get(e.id); t ? t.attributes.push(e) : this.attributeMutations.push(e) }, t.prototype.scroll = function (e) { this.scrollMap.set(e.id, e) }, t.prototype.input = function (e) { this.inputMap.set(e.id, e) }, t.prototype.flush = function () { var t, n, o, i, a = this, s = this.tree, c = this.removeNodeMutations, l = this.textMutations, u = this.attributeMutations, d = { source: e.IncrementalSource.Mutation, removes: c, texts: l, attributes: u, adds: [] }, p = function (e, t) { t && a.removeIdSet.add(e.id), d.texts = d.texts.concat(t ? [] : e.texts).filter((function (e) { return !a.removeIdSet.has(e.id) })), d.attributes = d.attributes.concat(t ? [] : e.attributes).filter((function (e) { return !a.removeIdSet.has(e.id) })), a.removeIdSet.has(e.id) || a.removeIdSet.has(e.mutation.parentId) || t ? Object.values(e.children).forEach((function (e) { return p(e, !0) })) : (d.adds.push(e.mutation), e.children && Object.values(e.children).forEach((function (e) { return p(e, !1) }))) }; Object.values(s).forEach((function (e) { return p(e, !1) })); try { for (var f = r(this.scrollMap.keys()), h = f.next(); !h.done; h = f.next()) { var v = h.value; this.removeIdSet.has(v) && this.scrollMap.delete(v) } } catch (e) { t = { error: e } } finally { try { h && !h.done && (n = f.return) && n.call(f) } finally { if (t) throw t.error } } try { for (var m = r(this.inputMap.keys()), y = m.next(); !y.done; y = m.next()) { v = y.value; this.removeIdSet.has(v) && this.inputMap.delete(v) } } catch (e) { o = { error: e } } finally { try { y && !y.done && (i = m.return) && i.call(m) } finally { if (o) throw o.error } } var g = new Map(this.scrollMap), b = new Map(this.inputMap); return this.reset(), { mutationData: d, scrollMap: g, inputMap: b } }, t.prototype.reset = function () { this.tree = [], this.indexes = new Map, this.removeNodeMutations = [], this.textMutations = [], this.attributeMutations = [], this.removeIdSet = new Set, this.scrollMap = new Map, this.inputMap = new Map }, t }(); function Y(e) { var t, n, o = {}, i = function (e, t) { var n = { value: e, parent: t, children: [] }; return o[e.node.id] = n, n }, a = []; try { for (var s = r(e), c = s.next(); !c.done; c = s.next()) { var l = c.value, u = l.nextId, d = l.parentId; if (u && u in o) { var p = o[u]; if (p.parent) { var f = p.parent.children.indexOf(p); p.parent.children.splice(f, 0, i(l, p.parent)) } else { f = a.indexOf(p); a.splice(f, 0, i(l, null)) } } else if (d in o) { var h = o[d]; h.children.push(i(l, h)) } else a.push(i(l, null)) } } catch (e) { t = { error: e } } finally { try { c && !c.done && (n = s.return) && n.call(s) } finally { if (t) throw t.error } } return a } function q(e, t) { t(e.value); for (var n = e.children.length - 1; n >= 0; n--)q(e.children[n], t) } var G = Object.freeze({ __proto__: null, on: A, mirror: D, throttle: L, hookSetter: F, patch: P, getWindowHeight: z, getWindowWidth: j, isBlocked: V, isAncestorRemoved: U, isTouchEvent: W, polyfill: B, needCastInSyncMode: H, TreeIndex: X, queueToResolveTrees: Y, iterateResolveTree: q }); function $(e) { return "__ln" in e } var K = function () { function e() { this.length = 0, this.head = null } return e.prototype.get = function (e) { if (e >= this.length) throw new Error("Position outside of list range"); for (var t = this.head, n = 0; n < e; n++)t = (null == t ? void 0 : t.next) || null; return t }, e.prototype.addNode = function (e) { var t = { value: e, previous: null, next: null }; if (e.__ln = t, e.previousSibling && $(e.previousSibling)) { var n = e.previousSibling.__ln.next; t.next = n, t.previous = e.previousSibling.__ln, e.previousSibling.__ln.next = t, n && (n.previous = t) } else if (e.nextSibling && $(e.nextSibling)) { n = e.nextSibling.__ln.previous; t.previous = n, t.next = e.nextSibling.__ln, e.nextSibling.__ln.previous = t, n && (n.next = t) } else this.head && (this.head.previous = t), t.next = this.head, this.head = t; this.length++ }, e.prototype.removeNode = function (e) { var t = e.__ln; this.head && (t.previous ? (t.previous.next = t.next, t.next && (t.next.previous = t.previous)) : (this.head = t.next, this.head && (this.head.previous = null)), e.__ln && delete e.__ln, this.length--) }, e }(), J = function (e, t) { return e + "@" + t }; function Z(e) { return "__sn" in e } function Q(e, t) { e.delete(t), t.childNodes.forEach((function (t) { return Q(e, t) })) } function ee(e, t) { var n = t.parentNode; if (!n) return !1; var r = D.getId(n); return !!e.some((function (e) { return e.id === r })) || ee(e, n) } function te(e, t) { var n = t.parentNode; return !!n && (!!e.has(n) || te(e, n)) } var ne = new (function () { function e() { var e = this; this.frozen = !1, this.texts = [], this.attributes = [], this.removes = [], this.mapRemoves = [], this.movedMap = {}, this.addedSet = new Set, this.movedSet = new Set, this.droppedSet = new Set, this.processMutations = function (t) { t.forEach(e.processMutation), e.frozen || e.emit() }, this.emit = function () { for (var t, n, o, i, a = [], s = new K, c = function (t) { var n = t.nextSibling && D.getId(t.nextSibling); return -1 === n && V(t.nextSibling, e.blockClass) && (n = null), n }, l = function (t) { if (t.parentNode) { var n = D.getId(t.parentNode), r = c(t); if (-1 === n || -1 === r) return s.addNode(t); a.push({ parentId: n, nextId: r, node: g(t, document, D.map, e.blockClass, null, !0, e.inlineStylesheet, e.maskInputOptions, void 0, e.recordCanvas) }) } }; e.mapRemoves.length;)D.removeNodeFromMap(e.mapRemoves.shift()); try { for (var u = r(e.movedSet), d = u.next(); !d.done; d = u.next()) { var p = d.value; ee(e.removes, p) && !e.movedSet.has(p.parentNode) || l(p) } } catch (e) { t = { error: e } } finally { try { d && !d.done && (n = u.return) && n.call(u) } finally { if (t) throw t.error } } try { for (var f = r(e.addedSet), h = f.next(); !h.done; h = f.next()) { p = h.value; te(e.droppedSet, p) || ee(e.removes, p) ? te(e.movedSet, p) ? l(p) : e.droppedSet.add(p) : l(p) } } catch (e) { o = { error: e } } finally { try { h && !h.done && (i = f.return) && i.call(f) } finally { if (o) throw o.error } } for (var v = null; s.length;) { var m = null; if (v) { var y = D.getId(v.value.parentNode), b = c(v.value); -1 !== y && -1 !== b && (m = v) } if (!m) for (var S = s.length - 1; S >= 0; S--) { var E = s.get(S); y = D.getId(E.value.parentNode), b = c(E.value); if (-1 !== y && -1 !== b) { m = E; break } } if (!m) break; v = m.previous, s.removeNode(m.value), l(m.value) } var w = { texts: e.texts.map((function (e) { return { id: D.getId(e.node), value: e.value } })).filter((function (e) { return D.has(e.id) })), attributes: e.attributes.map((function (e) { return { id: D.getId(e.node), attributes: e.attributes } })).filter((function (e) { return D.has(e.id) })), removes: e.removes, adds: a }; (w.texts.length || w.attributes.length || w.removes.length || w.adds.length) && (e.texts = [], e.attributes = [], e.removes = [], e.addedSet = new Set, e.movedSet = new Set, e.droppedSet = new Set, e.movedMap = {}, e.emissionCallback(w)) }, this.processMutation = function (t) { switch (t.type) { case "characterData": var n = t.target.textContent; V(t.target, e.blockClass) || n === t.oldValue || e.texts.push({ value: n, node: t.target }); break; case "attributes": n = t.target.getAttribute(t.attributeName); if (V(t.target, e.blockClass) || n === t.oldValue) return; var r = e.attributes.find((function (e) { return e.node === t.target })); r || (r = { node: t.target, attributes: {} }, e.attributes.push(r)), r.attributes[t.attributeName] = v(document, t.attributeName, n); break; case "childList": t.addedNodes.forEach((function (n) { return e.genAdds(n, t.target) })), t.removedNodes.forEach((function (n) { var r = D.getId(n), o = D.getId(t.target); V(n, e.blockClass) || V(t.target, e.blockClass) || (e.addedSet.has(n) ? (Q(e.addedSet, n), e.droppedSet.add(n)) : e.addedSet.has(t.target) && -1 === r || U(t.target) || (e.movedSet.has(n) && e.movedMap[J(r, o)] ? Q(e.movedSet, n) : e.removes.push({ parentId: o, id: r })), e.mapRemoves.push(n)) })) } }, this.genAdds = function (t, n) { if (!V(t, e.blockClass)) { if (Z(t)) { e.movedSet.add(t); var r = null; n && Z(n) && (r = n.__sn.id), r && (e.movedMap[J(t.__sn.id, r)] = !0) } else e.addedSet.add(t), e.droppedSet.delete(t); t.childNodes.forEach((function (t) { return e.genAdds(t) })) } } } return e.prototype.init = function (e, t, n, r, o) { this.blockClass = t, this.inlineStylesheet = n, this.maskInputOptions = r, this.recordCanvas = o, this.emissionCallback = e }, e.prototype.freeze = function () { this.frozen = !0 }, e.prototype.unfreeze = function () { this.frozen = !1 }, e.prototype.isFrozen = function () { return this.frozen }, e }()); function re(t, n, r) { if (!1 === r.mouseInteraction) return function () { }; var o = !0 === r.mouseInteraction || void 0 === r.mouseInteraction ? {} : r.mouseInteraction, i = []; return Object.keys(e.MouseInteractions).filter((function (e) { return Number.isNaN(Number(e)) && !e.endsWith("_Departed") && !1 !== o[e] })).forEach((function (r) { var o = r.toLowerCase(), a = function (r) { return function (o) { if (!V(o.target, n)) { var i = D.getId(o.target), a = W(o) ? o.changedTouches[0] : o, s = a.clientX, c = a.clientY; t({ type: e.MouseInteractions[r], id: i, x: s, y: c }) } } }(r); i.push(A(o, a)) })), function () { i.forEach((function (e) { return e() })) } } var oe, ie = ["INPUT", "TEXTAREA", "SELECT"], ae = new WeakMap; function se(t, o) { void 0 === o && (o = {}), function (e, t) { var n = e.mutationCb, r = e.mousemoveCb, o = e.mouseInteractionCb, a = e.scrollCb, s = e.viewportResizeCb, c = e.inputCb, l = e.mediaInteractionCb, u = e.styleSheetRuleCb, d = e.canvasMutationCb, p = e.fontCb; e.mutationCb = function () { for (var e = [], r = 0; r < arguments.length; r++)e[r] = arguments[r]; t.mutation && t.mutation.apply(t, i(e)), n.apply(void 0, i(e)) }, e.mousemoveCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.mousemove && t.mousemove.apply(t, i(e)), r.apply(void 0, i(e)) }, e.mouseInteractionCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.mouseInteraction && t.mouseInteraction.apply(t, i(e)), o.apply(void 0, i(e)) }, e.scrollCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.scroll && t.scroll.apply(t, i(e)), a.apply(void 0, i(e)) }, e.viewportResizeCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.viewportResize && t.viewportResize.apply(t, i(e)), s.apply(void 0, i(e)) }, e.inputCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.input && t.input.apply(t, i(e)), c.apply(void 0, i(e)) }, e.mediaInteractionCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.mediaInteaction && t.mediaInteaction.apply(t, i(e)), l.apply(void 0, i(e)) }, e.styleSheetRuleCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.styleSheetRule && t.styleSheetRule.apply(t, i(e)), u.apply(void 0, i(e)) }, e.canvasMutationCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.canvasMutation && t.canvasMutation.apply(t, i(e)), d.apply(void 0, i(e)) }, e.fontCb = function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; t.font && t.font.apply(t, i(e)), p.apply(void 0, i(e)) } }(t, o); var a, s, c = function (e, t, n, r, o) { ne.init(e, t, n, r, o); var i = new MutationObserver(ne.processMutations.bind(ne)); return i.observe(document, { attributes: !0, attributeOldValue: !0, characterData: !0, characterDataOldValue: !0, childList: !0, subtree: !0 }), i }(t.mutationCb, t.blockClass, t.inlineStylesheet, t.maskInputOptions, t.recordCanvas), l = function (t, n) { if (!1 === n.mousemove) return function () { }; var r, o = "number" == typeof n.mousemove ? n.mousemove : 50, i = [], a = L((function (n) { var o = Date.now() - r; t(i.map((function (e) { return e.timeOffset -= o, e })), n ? e.IncrementalSource.TouchMove : e.IncrementalSource.MouseMove), i = [], r = null }), 500), s = L((function (e) { var t = e.target, n = W(e) ? e.changedTouches[0] : e, o = n.clientX, s = n.clientY; r || (r = Date.now()), i.push({ x: o, y: s, id: D.getId(t), timeOffset: Date.now() - r }), a(W(e)) }), o, { trailing: !1 }), c = [A("mousemove", s), A("touchmove", s)]; return function () { c.forEach((function (e) { return e() })) } }(t.mousemoveCb, t.sampling), u = re(t.mouseInteractionCb, t.blockClass, t.sampling), d = (a = t.scrollCb, s = t.blockClass, A("scroll", L((function (e) { if (e.target && !V(e.target, s)) { var t = D.getId(e.target); if (e.target === document) { var n = document.scrollingElement || document.documentElement; a({ id: t, x: n.scrollLeft, y: n.scrollTop }) } else a({ id: t, x: e.target.scrollLeft, y: e.target.scrollTop }) } }), t.sampling.scroll || 100))), p = function (e) { return A("resize", L((function () { var t = z(), n = j(); e({ width: Number(n), height: Number(t) }) }), 200), window) }(t.viewportResizeCb), f = function (e, t, r, o, a) { function s(e) { var n = e.target; if (n && n.tagName && !(ie.indexOf(n.tagName) < 0) && !V(n, t)) { var i = n.type; if ("password" !== i && !n.classList.contains(r)) { var a = n.value, s = !1; "radio" === i || "checkbox" === i ? s = n.checked : (o[n.tagName.toLowerCase()] || o[i]) && (a = "*".repeat(a.length)), c(n, { text: a, isChecked: s }); var l = n.name; "radio" === i && l && s && document.querySelectorAll('input[type="radio"][name="' + l + '"]').forEach((function (e) { e !== n && c(e, { text: e.value, isChecked: !s }) })) } } } function c(t, r) { var o = ae.get(t); if (!o || o.text !== r.text || o.isChecked !== r.isChecked) { ae.set(t, r); var i = D.getId(t); e(n(n({}, r), { id: i })) } } var l = ("last" === a.input ? ["change"] : ["input", "change"]).map((function (e) { return A(e, s) })), u = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, "value"), d = [[HTMLInputElement.prototype, "value"], [HTMLInputElement.prototype, "checked"], [HTMLSelectElement.prototype, "value"], [HTMLTextAreaElement.prototype, "value"], [HTMLSelectElement.prototype, "selectedIndex"]]; return u && u.set && l.push.apply(l, i(d.map((function (e) { return F(e[0], e[1], { set: function () { s({ target: this }) } }) })))), function () { l.forEach((function (e) { return e() })) } }(t.inputCb, t.blockClass, t.ignoreClass, t.maskInputOptions, t.sampling), h = function (e, t) { var n = function (n) { return function (r) { var o = r.target; o && !V(o, t) && e({ type: "play" === n ? C.Play : C.Pause, id: D.getId(o) }) } }, r = [A("play", n("play")), A("pause", n("pause"))]; return function () { r.forEach((function (e) { return e() })) } }(t.mediaInteractionCb, t.blockClass), v = function (e) { var t = CSSStyleSheet.prototype.insertRule; CSSStyleSheet.prototype.insertRule = function (n, r) { var o = D.getId(this.ownerNode); return -1 !== o && e({ id: o, adds: [{ rule: n, index: r }] }), t.apply(this, arguments) }; var n = CSSStyleSheet.prototype.deleteRule; return CSSStyleSheet.prototype.deleteRule = function (t) { var r = D.getId(this.ownerNode); return -1 !== r && e({ id: r, removes: [{ index: t }] }), n.apply(this, arguments) }, function () { CSSStyleSheet.prototype.insertRule = t, CSSStyleSheet.prototype.deleteRule = n } }(t.styleSheetRuleCb), m = t.recordCanvas ? function (e, t) { var n, o, a = Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype), s = [], c = function (n) { try { if ("function" != typeof CanvasRenderingContext2D.prototype[n]) return "continue"; var r = P(CanvasRenderingContext2D.prototype, n, (function (r) { return function () { for (var o = this, a = [], s = 0; s < arguments.length; s++)a[s] = arguments[s]; return V(this.canvas, t) || setTimeout((function () { var t = i(a); "drawImage" === n && t[0] && t[0] instanceof HTMLCanvasElement && (t[0] = t[0].toDataURL()), e({ id: D.getId(o.canvas), property: n, args: t }) }), 0), r.apply(this, a) } })); s.push(r) } catch (t) { var o = F(CanvasRenderingContext2D.prototype, n, { set: function (t) { e({ id: D.getId(this.canvas), property: n, args: [t], setter: !0 }) } }); s.push(o) } }; try { for (var l = r(a), u = l.next(); !u.done; u = l.next()) { c(u.value) } } catch (e) { n = { error: e } } finally { try { u && !u.done && (o = l.return) && o.call(l) } finally { if (n) throw n.error } } return function () { s.forEach((function (e) { return e() })) } }(t.canvasMutationCb, t.blockClass) : function () { }, y = t.collectFonts ? function (e) { var t = [], n = new WeakMap, r = FontFace; window.FontFace = function (e, t, o) { var i = new r(e, t, o); return n.set(i, { family: e, buffer: "string" != typeof t, descriptors: o, fontSource: "string" == typeof t ? t : JSON.stringify(Array.from(new Uint8Array(t))) }), i }; var o = P(document.fonts, "add", (function (t) { return function (r) { return setTimeout((function () { var t = n.get(r); t && (e(t), n.delete(r)) }), 0), t.apply(this, [r]) } })); return t.push((function () { window.FonFace = r })), t.push(o), function () { t.forEach((function (e) { return e() })) } }(t.fontCb) : function () { }; return function () { c.disconnect(), l(), u(), d(), p(), f(), h(), v(), m(), y() } } function ce(e) { return n(n({}, e), { timestamp: Date.now() }) } function le(t) { void 0 === t && (t = {}); var r = t.emit, i = t.checkoutEveryNms, a = t.checkoutEveryNth, s = t.blockClass, c = void 0 === s ? "rr-block" : s, l = t.ignoreClass, u = void 0 === l ? "rr-ignore" : l, d = t.inlineStylesheet, p = void 0 === d || d, f = t.maskAllInputs, h = t.maskInputOptions, v = t.hooks, m = t.packFn, y = t.sampling, b = void 0 === y ? {} : y, S = t.mousemoveWait, E = t.recordCanvas, w = void 0 !== E && E, x = t.collectFonts, T = void 0 !== x && x; if (!r) throw new Error("emit function is required"); void 0 !== S && void 0 === b.mousemove && (b.mousemove = S); var I, C = !0 === f ? { color: !0, date: !0, "datetime-local": !0, email: !0, month: !0, number: !0, range: !0, search: !0, tel: !0, text: !0, time: !0, url: !0, week: !0, textarea: !0, select: !0 } : void 0 !== h ? h : {}; B(); var M = 0; function N(t) { var n, r, i, a; void 0 === t && (t = !1), oe(ce({ type: e.EventType.Meta, data: { href: window.location.href, width: j(), height: z() } }), t); var s = ne.isFrozen(); ne.freeze(); var l = o(function (e, t, n, r, o, i, a) { void 0 === t && (t = "rr-block"), void 0 === n && (n = !0), void 0 === a && (a = null); var s = {}; return [g(e, e, s, t, a, !1, n, !0 === r ? { color: !0, date: !0, "datetime-local": !0, email: !0, month: !0, number: !0, range: !0, search: !0, tel: !0, text: !0, time: !0, url: !0, week: !0, textarea: !0, select: !0 } : !1 === r ? {} : r, !0 === o || "all" === o ? { script: !0, comment: !0, headFavicon: !0, headWhitespace: !0, headMetaDescKeywords: "all" === o, headMetaSocial: !0, headMetaRobots: !0, headMetaHttpEquiv: !0, headMetaAuthorship: !0, headMetaVerification: !0 } : !1 === o ? {} : o, i), s] }(document, c, p, C, !1, w), 2), u = l[0], d = l[1]; if (!u) return console.warn("Failed to snapshot the document"); D.map = d, oe(ce({ type: e.EventType.FullSnapshot, data: { node: u, initialOffset: { left: void 0 !== window.pageXOffset ? window.pageXOffset : (null === document || void 0 === document ? void 0 : document.documentElement.scrollLeft) || (null === (r = null === (n = null === document || void 0 === document ? void 0 : document.body) || void 0 === n ? void 0 : n.parentElement) || void 0 === r ? void 0 : r.scrollLeft) || (null === document || void 0 === document ? void 0 : document.body.scrollLeft) || 0, top: void 0 !== window.pageYOffset ? window.pageYOffset : (null === document || void 0 === document ? void 0 : document.documentElement.scrollTop) || (null === (a = null === (i = null === document || void 0 === document ? void 0 : document.body) || void 0 === i ? void 0 : i.parentElement) || void 0 === a ? void 0 : a.scrollTop) || (null === document || void 0 === document ? void 0 : document.body.scrollTop) || 0 } } })), s || (ne.emit(), ne.unfreeze()) } oe = function (t, n) { if (!ne.isFrozen() || t.type === e.EventType.FullSnapshot || t.type == e.EventType.IncrementalSnapshot && t.data.source == e.IncrementalSource.Mutation || (ne.emit(), ne.unfreeze()), r(m ? m(t) : t, n), t.type === e.EventType.FullSnapshot) I = t, M = 0; else if (t.type === e.EventType.IncrementalSnapshot) { M++; var o = a && M >= a, s = i && t.timestamp - I.timestamp > i; (o || s) && N(!0) } }; try { var _ = []; _.push(A("DOMContentLoaded", (function () { oe(ce({ type: e.EventType.DomContentLoaded, data: {} })) }))); var k = function () { N(), _.push(se({ mutationCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.Mutation }, t) })) }, mousemoveCb: function (t, n) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: { source: n, positions: t } })) }, mouseInteractionCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.MouseInteraction }, t) })) }, scrollCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.Scroll }, t) })) }, viewportResizeCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.ViewportResize }, t) })) }, inputCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.Input }, t) })) }, mediaInteractionCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.MediaInteraction }, t) })) }, styleSheetRuleCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.StyleSheetRule }, t) })) }, canvasMutationCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.CanvasMutation }, t) })) }, fontCb: function (t) { return oe(ce({ type: e.EventType.IncrementalSnapshot, data: n({ source: e.IncrementalSource.Font }, t) })) }, blockClass: c, ignoreClass: u, maskInputOptions: C, inlineStylesheet: p, sampling: b, recordCanvas: w, collectFonts: T }, v)) }; return "interactive" === document.readyState || "complete" === document.readyState ? k() : _.push(A("load", (function () { oe(ce({ type: e.EventType.Load, data: {} })), k() }), window)), function () { _.forEach((function (e) { return e() })) } } catch (e) { console.warn(e) } } function ue(e) { return e = e || Object.create(null), { on: function (t, n) { (e[t] || (e[t] = [])).push(n) }, off: function (t, n) { e[t] && e[t].splice(e[t].indexOf(n) >>> 0, 1) }, emit: function (t, n) { (e[t] || []).slice().map((function (e) { e(n) })), (e["*"] || []).slice().map((function (e) { e(t, n) })) } } } le.addCustomEvent = function (t, n) { if (!oe) throw new Error("please add custom event after start recording"); oe(ce({ type: e.EventType.Custom, data: { tag: t, payload: n } })) }, le.freezePage = function () { ne.freeze() }; var de = Object.freeze({ __proto__: null, default: ue }); function pe(e, t) { if (void 0 === e && (e = window), void 0 === t && (t = document), !("scrollBehavior" in t.documentElement.style) || !0 === e.__forceSmoothScrollPolyfill__) { var n, r = e.HTMLElement || e.Element, o = { scroll: e.scroll || e.scrollTo, scrollBy: e.scrollBy, elementScroll: r.prototype.scroll || s, scrollIntoView: r.prototype.scrollIntoView }, i = e.performance && e.performance.now ? e.performance.now.bind(e.performance) : Date.now, a = (n = e.navigator.userAgent, new RegExp(["MSIE ", "Trident/", "Edge/"].join("|")).test(n) ? 1 : 0); e.scroll = e.scrollTo = function () { void 0 !== arguments[0] && (!0 !== c(arguments[0]) ? h.call(e, t.body, void 0 !== arguments[0].left ? ~~arguments[0].left : e.scrollX || e.pageXOffset, void 0 !== arguments[0].top ? ~~arguments[0].top : e.scrollY || e.pageYOffset) : o.scroll.call(e, void 0 !== arguments[0].left ? arguments[0].left : "object" != typeof arguments[0] ? arguments[0] : e.scrollX || e.pageXOffset, void 0 !== arguments[0].top ? arguments[0].top : void 0 !== arguments[1] ? arguments[1] : e.scrollY || e.pageYOffset)) }, e.scrollBy = function () { void 0 !== arguments[0] && (c(arguments[0]) ? o.scrollBy.call(e, void 0 !== arguments[0].left ? arguments[0].left : "object" != typeof arguments[0] ? arguments[0] : 0, void 0 !== arguments[0].top ? arguments[0].top : void 0 !== arguments[1] ? arguments[1] : 0) : h.call(e, t.body, ~~arguments[0].left + (e.scrollX || e.pageXOffset), ~~arguments[0].top + (e.scrollY || e.pageYOffset))) }, r.prototype.scroll = r.prototype.scrollTo = function () { if (void 0 !== arguments[0]) if (!0 !== c(arguments[0])) { var e = arguments[0].left, t = arguments[0].top; h.call(this, this, void 0 === e ? this.scrollLeft : ~~e, void 0 === t ? this.scrollTop : ~~t) } else { if ("number" == typeof arguments[0] && void 0 === arguments[1]) throw new SyntaxError("Value could not be converted"); o.elementScroll.call(this, void 0 !== arguments[0].left ? ~~arguments[0].left : "object" != typeof arguments[0] ? ~~arguments[0] : this.scrollLeft, void 0 !== arguments[0].top ? ~~arguments[0].top : void 0 !== arguments[1] ? ~~arguments[1] : this.scrollTop) } }, r.prototype.scrollBy = function () { void 0 !== arguments[0] && (!0 !== c(arguments[0]) ? this.scroll({ left: ~~arguments[0].left + this.scrollLeft, top: ~~arguments[0].top + this.scrollTop, behavior: arguments[0].behavior }) : o.elementScroll.call(this, void 0 !== arguments[0].left ? ~~arguments[0].left + this.scrollLeft : ~~arguments[0] + this.scrollLeft, void 0 !== arguments[0].top ? ~~arguments[0].top + this.scrollTop : ~~arguments[1] + this.scrollTop)) }, r.prototype.scrollIntoView = function () { if (!0 !== c(arguments[0])) { var n = p(this), r = n.getBoundingClientRect(), i = this.getBoundingClientRect(); n !== t.body ? (h.call(this, n, n.scrollLeft + i.left - r.left, n.scrollTop + i.top - r.top), "fixed" !== e.getComputedStyle(n).position && e.scrollBy({ left: r.left, top: r.top, behavior: "smooth" })) : e.scrollBy({ left: i.left, top: i.top, behavior: "smooth" }) } else o.scrollIntoView.call(this, void 0 === arguments[0] || arguments[0]) } } function s(e, t) { this.scrollLeft = e, this.scrollTop = t } function c(e) { if (null === e || "object" != typeof e || void 0 === e.behavior || "auto" === e.behavior || "instant" === e.behavior) return !0; if ("object" == typeof e && "smooth" === e.behavior) return !1; throw new TypeError("behavior member of ScrollOptions " + e.behavior + " is not a valid value for enumeration ScrollBehavior.") } function l(e, t) { return "Y" === t ? e.clientHeight + a < e.scrollHeight : "X" === t ? e.clientWidth + a < e.scrollWidth : void 0 } function u(t, n) { var r = e.getComputedStyle(t, null)["overflow" + n]; return "auto" === r || "scroll" === r } function d(e) { var t = l(e, "Y") && u(e, "Y"), n = l(e, "X") && u(e, "X"); return t || n } function p(e) { for (; e !== t.body && !1 === d(e);)e = e.parentNode || e.host; return e } function f(t) { var n, r, o, a, s = (i() - t.startTime) / 468; a = s = s > 1 ? 1 : s, n = .5 * (1 - Math.cos(Math.PI * a)), r = t.startX + (t.x - t.startX) * n, o = t.startY + (t.y - t.startY) * n, t.method.call(t.scrollable, r, o), r === t.x && o === t.y || e.requestAnimationFrame(f.bind(e, t)) } function h(n, r, a) { var c, l, u, d, p = i(); n === t.body ? (c = e, l = e.scrollX || e.pageXOffset, u = e.scrollY || e.pageYOffset, d = o.scroll) : (c = n, l = n.scrollLeft, u = n.scrollTop, d = s), f({ scrollable: c, method: d, startTime: p, startX: l, startY: u, x: r, y: a }) } } var fe, he = function () { function e(e, t) { void 0 === e && (e = []), this.timeOffset = 0, this.raf = null, this.actions = e, this.speed = t } return e.prototype.addAction = function (e) { var t = this.findActionIndex(e); this.actions.splice(t, 0, e) }, e.prototype.addActions = function (e) { var t; (t = this.actions).push.apply(t, i(e)) }, e.prototype.start = function () { this.actions.sort((function (e, t) { return e.delay - t.delay })), this.timeOffset = 0; var e = performance.now(), t = this.actions, n = this; this.raf = requestAnimationFrame((function r(o) { for (n.timeOffset += (o - e) * n.speed, e = o; t.length;) { var i = t[0]; if (!(n.timeOffset >= i.delay)) break; t.shift(), i.doAction() } (t.length > 0 || n.liveMode) && (n.raf = requestAnimationFrame(r)) })) }, e.prototype.clear = function () { this.raf && (cancelAnimationFrame(this.raf), this.raf = null), this.actions.length = 0 }, e.prototype.setSpeed = function (e) { this.speed = e }, e.prototype.toggleLiveMode = function (e) { this.liveMode = e }, e.prototype.isActive = function () { return null !== this.raf }, e.prototype.findActionIndex = function (e) { for (var t = 0, n = this.actions.length - 1; t <= n;) { var r = Math.floor((t + n) / 2); if (this.actions[r].delay < e.delay) t = r + 1; else { if (!(this.actions[r].delay > e.delay)) return r; n = r - 1 } } return t }, e }(); function ve(t, n) { if (t.type === e.EventType.IncrementalSnapshot && t.data.source === e.IncrementalSource.MouseMove) { var r = t.data.positions[0].timeOffset, o = t.timestamp + r; return t.delay = o - n, o - n } return t.delay = t.timestamp - n, t.delay }
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */!function (e) { e[e.NotStarted = 0] = "NotStarted", e[e.Running = 1] = "Running", e[e.Stopped = 2] = "Stopped" }(fe || (fe = {})); var me = { type: "xstate.init" }; function ye(e) { return void 0 === e ? [] : [].concat(e) } function ge(e) { return { type: "xstate.assign", assignment: e } } function be(e, t) { return "string" == typeof (e = "string" == typeof e && t && t[e] ? t[e] : e) ? { type: e } : "function" == typeof e ? { type: e.name, exec: e } : e } function Se(e) { return function (t) { return e === t } } function Ee(e) { return "string" == typeof e ? { type: e } : e } function we(e, t) { return { value: e, context: t, actions: [], changed: !1, matches: Se(e) } } function xe(e, t) { void 0 === t && (t = {}); var n = { config: e, _options: t, initialState: { value: e.initial, actions: ye(e.states[e.initial].entry).map((function (e) { return be(e, t.actions) })), context: e.context, matches: Se(e.initial) }, transition: function (t, r) { var o, i, a = "string" == typeof t ? { value: t, context: e.context } : t, s = a.value, c = a.context, l = Ee(r), u = e.states[s]; if (u.on) { var d = ye(u.on[l.type]), p = function (t) { if (void 0 === t) return { value: we(s, c) }; var r = "string" == typeof t ? { target: t } : t, o = r.target, i = void 0 === o ? s : o, a = r.actions, d = void 0 === a ? [] : a, p = r.cond, f = c; if ((void 0 === p ? function () { return !0 } : p)(c, l)) { var h = e.states[i], v = !1, m = [].concat(u.exit, d, h.entry).filter((function (e) { return e })).map((function (e) { return be(e, n._options.actions) })).filter((function (e) { if ("xstate.assign" === e.type) { v = !0; var t = Object.assign({}, f); return "function" == typeof e.assignment ? t = e.assignment(f, l) : Object.keys(e.assignment).forEach((function (n) { t[n] = "function" == typeof e.assignment[n] ? e.assignment[n](f, l) : e.assignment[n] })), f = t, !1 } return !0 })); return { value: { value: i, context: f, actions: m, changed: i !== s || m.length > 0 || v, matches: Se(i) } } } }; try { for (var f = function (e) { var t = "function" == typeof Symbol && e[Symbol.iterator], n = 0; return t ? t.call(e) : { next: function () { return e && n >= e.length && (e = void 0), { value: e && e[n++], done: !e } } } }(d), h = f.next(); !h.done; h = f.next()) { var v = p(h.value); if ("object" == typeof v) return v.value } } catch (e) { o = { error: e } } finally { try { h && !h.done && (i = f.return) && i.call(f) } finally { if (o) throw o.error } } } return we(s, c) } }; return n } var Te = function (e, t) { return e.actions.forEach((function (n) { var r = n.exec; return r && r(e.context, t) })) }; function Ie(e) { var t = e.initialState, n = fe.NotStarted, r = new Set, o = { _machine: e, send: function (o) { n === fe.Running && (t = e.transition(t, o), Te(t, Ee(o)), r.forEach((function (e) { return e(t) }))) }, subscribe: function (e) { return r.add(e), e(t), { unsubscribe: function () { return r.delete(e) } } }, start: function (r) { if (r) { var i = "object" == typeof r ? r : { context: e.config.context, value: r }; t = { value: i.value, actions: [], context: i.context, matches: Se(i.value) } } return n = fe.Running, Te(t, me), o }, stop: function () { return n = fe.Stopped, r.clear(), o }, get state() { return t }, get status() { return n } }; return o } function Ce(t, o) { var i = o.getCastFn, a = o.emitter; return Ie(xe({ id: "player", context: t, initial: "paused", states: { playing: { on: { PAUSE: { target: "paused", actions: ["pause"] }, CAST_EVENT: { target: "playing", actions: "castEvent" }, END: { target: "paused", actions: ["resetLastPlayedEvent", "pause"] }, ADD_EVENT: { target: "playing", actions: ["addEvent"] } } }, paused: { on: { PLAY: { target: "playing", actions: ["recordTimeOffset", "play"] }, CAST_EVENT: { target: "paused", actions: "castEvent" }, TO_LIVE: { target: "live", actions: ["startLive"] }, ADD_EVENT: { target: "paused", actions: ["addEvent"] } } }, live: { on: { ADD_EVENT: { target: "live", actions: ["addEvent"] }, CAST_EVENT: { target: "live", actions: ["castEvent"] } } } } }, { actions: { castEvent: ge({ lastPlayedEvent: function (e, t) { return "CAST_EVENT" === t.type ? t.payload.event : e.lastPlayedEvent } }), recordTimeOffset: ge((function (e, t) { var r = e.timeOffset; return "payload" in t && "timeOffset" in t.payload && (r = t.payload.timeOffset), n(n({}, e), { timeOffset: r, baselineTime: e.events[0].timestamp + r }) })), play: function (t) { var n, o, s, c, l, u = t.timer, d = t.events, p = t.baselineTime, f = t.lastPlayedEvent; u.clear(); try { for (var h = r(d), v = h.next(); !v.done; v = h.next()) { ve(v.value, p) } } catch (e) { n = { error: e } } finally { try { v && !v.done && (o = h.return) && o.call(h) } finally { if (n) throw n.error } } var m = function (t, n) { for (var r = t.length - 1; r >= 0; r--) { var o = t[r]; if (o.type === e.EventType.Meta && o.timestamp <= n) return t.slice(r) } return t }(d, p), y = new Array, g = function (t) { var n = null == f ? void 0 : f.timestamp; if ((null == f ? void 0 : f.type) === e.EventType.IncrementalSnapshot && f.data.source === e.IncrementalSource.MouseMove && (n = f.timestamp + (null === (l = f.data.positions[0]) || void 0 === l ? void 0 : l.timeOffset)), n && n < p && (t.timestamp <= n || t === f)) return "continue"; var r = t.timestamp < p; if (r && !H(t)) return "continue"; var o = i(t, r); r ? o() : y.push({ doAction: function () { o(), a.emit(e.ReplayerEvents.EventCast, t) }, delay: t.delay }) }; try { for (var b = r(m), S = b.next(); !S.done; S = b.next()) { g(S.value) } } catch (e) { s = { error: e } } finally { try { S && !S.done && (c = b.return) && c.call(b) } finally { if (s) throw s.error } } a.emit(e.ReplayerEvents.Flush), u.addActions(y), u.start() }, pause: function (e) { e.timer.clear() }, resetLastPlayedEvent: ge((function (e) { return n(n({}, e), { lastPlayedEvent: null }) })), startLive: ge({ baselineTime: function (e, t) { return e.timer.toggleLiveMode(!0), e.timer.start(), "TO_LIVE" === t.type && t.payload.baselineTime ? t.payload.baselineTime : Date.now() } }), addEvent: ge((function (t, r) { var o = t.baselineTime, s = t.timer, c = t.events; if ("ADD_EVENT" === r.type) { var l = r.payload.event; ve(l, o), c.push(l); var u = l.timestamp < o, d = i(l, u); u ? d() : (s.addAction({ doAction: function () { d(), a.emit(e.ReplayerEvents.EventCast, l) }, delay: l.delay }), s.isActive() || s.start()) } return n(n({}, t), { events: c }) })) } })) } var Me = ue || de, Ne = { duration: 500, lineCap: "round", lineWidth: 3, strokeStyle: "red" }, _e = function () { function a(n, i) { var a = this; if (this.mouseTail = null, this.tailPositions = [], this.emitter = Me(), this.legacy_missingNodeRetryMap = {}, this.imageMap = new Map, !(null == i ? void 0 : i.liveMode) && n.length < 2) throw new Error("Replayer need at least 2 events."); var s = { speed: 1, root: document.body, loadTimeout: 0, skipInactive: !1, showWarning: !0, showDebug: !1, blockClass: "rr-block", liveMode: !1, insertStyleRules: [], triggerFocus: !0, UNSAFE_replayCanvas: !1, mouseTail: Ne }; this.config = Object.assign({}, s, i), this.handleResize = this.handleResize.bind(this), this.getCastFn = this.getCastFn.bind(this), this.emitter.on(e.ReplayerEvents.Resize, this.handleResize), this.setupDom(), this.treeIndex = new X, this.fragmentParentMap = new Map, this.emitter.on(e.ReplayerEvents.Flush, (function () { var e, n, i, s, c, l, u = a.treeIndex.flush(), d = u.scrollMap, p = u.inputMap; try { for (var f = r(d.values()), h = f.next(); !h.done; h = f.next()) { var v = h.value; a.applyScroll(v) } } catch (t) { e = { error: t } } finally { try { h && !h.done && (n = f.return) && n.call(f) } finally { if (e) throw e.error } } try { for (var m = r(p.values()), y = m.next(); !y.done; y = m.next()) { v = y.value; a.applyInput(v) } } catch (e) { i = { error: e } } finally { try { y && !y.done && (s = m.return) && s.call(m) } finally { if (i) throw i.error } } try { for (var g = r(a.fragmentParentMap.entries()), b = g.next(); !b.done; b = g.next()) { var S = o(b.value, 2), E = S[0], w = S[1]; D.map[w.__sn.id] = w, w.__sn.type === t.Element && "textarea" === w.__sn.tagName && E.textContent && (w.value = E.textContent), w.appendChild(E) } } catch (e) { c = { error: e } } finally { try { b && !b.done && (l = g.return) && l.call(g) } finally { if (c) throw c.error } } a.fragmentParentMap.clear() })); var c = new he([], (null == i ? void 0 : i.speed) || s.speed); this.service = Ce({ events: n.map((function (e) { return i && i.unpackFn ? i.unpackFn(e) : e })), timer: c, timeOffset: 0, baselineTime: 0, lastPlayedEvent: null }, { getCastFn: this.getCastFn, emitter: this.emitter }), this.service.start(), this.service.subscribe((function (t) { a.emitter.emit(e.ReplayerEvents.StateChange, { player: t }) })), this.speedService = Ie(xe({ id: "speed", context: { normalSpeed: -1, timer: c }, initial: "normal", states: { normal: { on: { FAST_FORWARD: { target: "skipping", actions: ["recordSpeed", "setSpeed"] }, SET_SPEED: { target: "normal", actions: ["setSpeed"] } } }, skipping: { on: { BACK_TO_NORMAL: { target: "normal", actions: ["restoreSpeed"] }, SET_SPEED: { target: "normal", actions: ["setSpeed"] } } } } }, { actions: { setSpeed: function (e, t) { "payload" in t && e.timer.setSpeed(t.payload.speed) }, recordSpeed: ge({ normalSpeed: function (e) { return e.timer.speed } }), restoreSpeed: function (e) { e.timer.setSpeed(e.normalSpeed) } } })), this.speedService.start(), this.speedService.subscribe((function (t) { a.emitter.emit(e.ReplayerEvents.StateChange, { speed: t }) })); var l = this.service.state.context.events.find((function (t) { return t.type === e.EventType.Meta })), u = this.service.state.context.events.find((function (t) { return t.type === e.EventType.FullSnapshot })); if (l) { var d = l.data, p = d.width, f = d.height; setTimeout((function () { a.emitter.emit(e.ReplayerEvents.Resize, { width: p, height: f }) }), 0) } u && this.rebuildFullSnapshot(u) } return Object.defineProperty(a.prototype, "timer", { get: function () { return this.service.state.context.timer }, enumerable: !1, configurable: !0 }), a.prototype.on = function (e, t) { this.emitter.on(e, t) }, a.prototype.setConfig = function (e) { var t = this; Object.keys(e).forEach((function (n) { t.config[n] = e[n] })), this.config.skipInactive || this.backToNormal(), void 0 !== e.speed && this.speedService.send({ type: "SET_SPEED", payload: { speed: e.speed } }) }, a.prototype.getMetaData = function () { var e = this.service.state.context.events[0], t = this.service.state.context.events[this.service.state.context.events.length - 1]; return { startTime: e.timestamp, endTime: t.timestamp, totalTime: t.timestamp - e.timestamp } }, a.prototype.getCurrentTime = function () { return this.timer.timeOffset + this.getTimeOffset() }, a.prototype.getTimeOffset = function () { var e = this.service.state.context; return e.baselineTime - e.events[0].timestamp }, a.prototype.play = function (t) { void 0 === t && (t = 0), this.service.state.matches("paused") || this.service.send({ type: "PAUSE" }), this.service.send({ type: "PLAY", payload: { timeOffset: t } }), this.emitter.emit(e.ReplayerEvents.Start) }, a.prototype.pause = function (t) { void 0 === t && this.service.state.matches("playing") && this.service.send({ type: "PAUSE" }), "number" == typeof t && (this.play(t), this.service.send({ type: "PAUSE" })), this.emitter.emit(e.ReplayerEvents.Pause) }, a.prototype.resume = function (t) { void 0 === t && (t = 0), console.warn("The 'resume' will be departed in 1.0. Please use 'play' method which has the same interface."), this.play(t), this.emitter.emit(e.ReplayerEvents.Resume) }, a.prototype.startLive = function (e) { this.service.send({ type: "TO_LIVE", payload: { baselineTime: e } }) }, a.prototype.addEvent = function (e) { var t = this, n = this.config.unpackFn ? this.config.unpackFn(e) : e; Promise.resolve().then((function () { return t.service.send({ type: "ADD_EVENT", payload: { event: n } }) })) }, a.prototype.enableInteract = function () { this.iframe.setAttribute("scrolling", "auto"), this.iframe.style.pointerEvents = "auto" }, a.prototype.disableInteract = function () { this.iframe.setAttribute("scrolling", "no"), this.iframe.style.pointerEvents = "none" }, a.prototype.setupDom = function () { this.wrapper = document.createElement("div"), this.wrapper.classList.add("replayer-wrapper"), this.config.root.appendChild(this.wrapper), this.mouse = document.createElement("div"), this.mouse.classList.add("replayer-mouse"), this.wrapper.appendChild(this.mouse), !1 !== this.config.mouseTail && (this.mouseTail = document.createElement("canvas"), this.mouseTail.classList.add("replayer-mouse-tail"), this.mouseTail.style.display = "none", this.wrapper.appendChild(this.mouseTail)), this.iframe = document.createElement("iframe"); var e = ["allow-same-origin"]; this.config.UNSAFE_replayCanvas && e.push("allow-scripts"), this.iframe.style.display = "none", this.iframe.setAttribute("sandbox", e.join(" ")), this.disableInteract(), this.wrapper.appendChild(this.iframe), this.iframe.contentWindow && this.iframe.contentDocument && (pe(this.iframe.contentWindow, this.iframe.contentDocument), B(this.iframe.contentWindow)) }, a.prototype.handleResize = function (e) { var t, n; try { for (var o = r([this.mouseTail, this.iframe]), i = o.next(); !i.done; i = o.next()) { var a = i.value; a && (a.style.display = "inherit", a.setAttribute("width", String(e.width)), a.setAttribute("height", String(e.height))) } } catch (e) { t = { error: e } } finally { try { i && !i.done && (n = o.return) && n.call(o) } finally { if (t) throw t.error } } }, a.prototype.getCastFn = function (t, n) { var o, i = this; switch (void 0 === n && (n = !1), t.type) { case e.EventType.DomContentLoaded: case e.EventType.Load: break; case e.EventType.Custom: o = function () { i.emitter.emit(e.ReplayerEvents.CustomEvent, t) }; break; case e.EventType.Meta: o = function () { return i.emitter.emit(e.ReplayerEvents.Resize, { width: t.data.width, height: t.data.height }) }; break; case e.EventType.FullSnapshot: o = function () { i.rebuildFullSnapshot(t, n), i.iframe.contentWindow.scrollTo(t.data.initialOffset) }; break; case e.EventType.IncrementalSnapshot: o = function () { var o, a; if (i.applyIncremental(t, n), !n && (t === i.nextUserInteractionEvent && (i.nextUserInteractionEvent = null, i.backToNormal()), i.config.skipInactive && !i.nextUserInteractionEvent)) { try { for (var s = r(i.service.state.context.events), c = s.next(); !c.done; c = s.next()) { var l = c.value; if (!(l.timestamp <= t.timestamp) && i.isUserInteraction(l)) { l.delay - t.delay > 1e4 * i.speedService.state.context.timer.speed && (i.nextUserInteractionEvent = l); break } } } catch (e) { o = { error: e } } finally { try { c && !c.done && (a = s.return) && a.call(s) } finally { if (o) throw o.error } } if (i.nextUserInteractionEvent) { var u = i.nextUserInteractionEvent.delay - t.delay, d = { speed: Math.min(Math.round(u / 5e3), 360) }; i.speedService.send({ type: "FAST_FORWARD", payload: d }), i.emitter.emit(e.ReplayerEvents.SkipStart, d) } } } }return function () { if (o && o(), i.service.send({ type: "CAST_EVENT", payload: { event: t } }), t === i.service.state.context.events[i.service.state.context.events.length - 1]) { var n = function () { i.backToNormal(), i.service.send("END"), i.emitter.emit(e.ReplayerEvents.Finish) }; t.type === e.EventType.IncrementalSnapshot && t.data.source === e.IncrementalSource.MouseMove && t.data.positions.length ? setTimeout((function () { n() }), Math.max(0, -t.data.positions[0].timeOffset)) : n() } } }, a.prototype.rebuildFullSnapshot = function (t, n) { if (void 0 === n && (n = !1), !this.iframe.contentDocument) return console.warn("Looks like your replayer has been destroyed."); Object.keys(this.legacy_missingNodeRetryMap).length && console.warn("Found unresolved missing node map", this.legacy_missingNodeRetryMap), this.legacy_missingNodeRetryMap = {}, D.map = O(t.data.node, this.iframe.contentDocument)[1]; var r = document.createElement("style"), o = this.iframe.contentDocument, i = o.documentElement, a = o.head; i.insertBefore(r, a); for (var s, c = (s = this.config.blockClass, ["iframe, ." + s + " { background: #ccc }", "noscript { display: none !important; }"]).concat(this.config.insertStyleRules), l = 0; l < c.length; l++)r.sheet.insertRule(c[l], l); this.emitter.emit(e.ReplayerEvents.FullsnapshotRebuilded, t), n || this.waitForStylesheetLoad(), this.config.UNSAFE_replayCanvas && this.preloadAllImages() }, a.prototype.waitForStylesheetLoad = function () { var t, n = this, r = null === (t = this.iframe.contentDocument) || void 0 === t ? void 0 : t.head; if (r) { var o, i = new Set, a = this.service.state, s = function () { a = n.service.state }; this.emitter.on(e.ReplayerEvents.Start, s), this.emitter.on(e.ReplayerEvents.Pause, s); var c = function () { n.emitter.off(e.ReplayerEvents.Start, s), n.emitter.off(e.ReplayerEvents.Pause, s) }; r.querySelectorAll('link[rel="stylesheet"]').forEach((function (t) { t.sheet || (i.add(t), t.addEventListener("load", (function () { i.delete(t), 0 === i.size && -1 !== o && (a.matches("playing") && n.play(n.getCurrentTime()), n.emitter.emit(e.ReplayerEvents.LoadStylesheetEnd), o && window.clearTimeout(o), c()) }))) })), i.size > 0 && (this.service.send({ type: "PAUSE" }), this.emitter.emit(e.ReplayerEvents.LoadStylesheetStart), o = window.setTimeout((function () { a.matches("playing") && n.play(n.getCurrentTime()), o = -1, c() }), this.config.loadTimeout)) } }, a.prototype.preloadAllImages = function () { var t, n, o = this, i = this.service.state, a = function () { i = o.service.state }; this.emitter.on(e.ReplayerEvents.Start, a), this.emitter.on(e.ReplayerEvents.Pause, a); var s = 0, c = 0; try { for (var l = r(this.service.state.context.events), u = l.next(); !u.done; u = l.next()) { var d = u.value; if (d.type === e.EventType.IncrementalSnapshot && d.data.source === e.IncrementalSource.CanvasMutation && "drawImage" === d.data.property && "string" == typeof d.data.args[0] && !this.imageMap.has(d)) { s++; var p = document.createElement("img"); p.src = d.data.args[0], this.imageMap.set(d, p), p.onload = function () { ++c === s && (i.matches("playing") && o.play(o.getCurrentTime()), o.emitter.off(e.ReplayerEvents.Start, a), o.emitter.off(e.ReplayerEvents.Pause, a)) } } } } catch (e) { t = { error: e } } finally { try { u && !u.done && (n = l.return) && n.call(l) } finally { if (t) throw t.error } } s !== c && this.service.send({ type: "PAUSE" }) }, a.prototype.applyIncremental = function (t, n) { var r, o, i = this, a = t.data; switch (a.source) { case e.IncrementalSource.Mutation: n && (a.adds.forEach((function (e) { return i.treeIndex.add(e) })), a.texts.forEach((function (e) { return i.treeIndex.text(e) })), a.attributes.forEach((function (e) { return i.treeIndex.attribute(e) })), a.removes.forEach((function (e) { return i.treeIndex.remove(e) }))), this.applyMutation(a, n); break; case e.IncrementalSource.MouseMove: if (n) { var s = a.positions[a.positions.length - 1]; this.moveAndHover(a, s.x, s.y, s.id) } else a.positions.forEach((function (e) { var n = { doAction: function () { i.moveAndHover(a, e.x, e.y, e.id) }, delay: e.timeOffset + t.timestamp - i.service.state.context.baselineTime }; i.timer.addAction(n) })), this.timer.addAction({ doAction: function () { }, delay: t.delay - (null === (r = a.positions[0]) || void 0 === r ? void 0 : r.timeOffset) }); break; case e.IncrementalSource.MouseInteraction: if (-1 === a.id) break; var c = new Event(e.MouseInteractions[a.type].toLowerCase()); if (!(y = D.getNode(a.id))) return this.debugNodeNotFound(a, a.id); this.emitter.emit(e.ReplayerEvents.MouseInteraction, { type: a.type, target: y }); var l = this.config.triggerFocus; switch (a.type) { case e.MouseInteractions.Blur: "blur" in y && y.blur(); break; case e.MouseInteractions.Focus: l && y.focus && y.focus({ preventScroll: !0 }); break; case e.MouseInteractions.Click: case e.MouseInteractions.TouchStart: case e.MouseInteractions.TouchEnd: n || (this.moveAndHover(a, a.x, a.y, a.id), this.mouse.classList.remove("active"), this.mouse.offsetWidth, this.mouse.classList.add("active")); break; default: y.dispatchEvent(c) }break; case e.IncrementalSource.Scroll: if (-1 === a.id) break; if (n) { this.treeIndex.scroll(a); break } this.applyScroll(a); break; case e.IncrementalSource.ViewportResize: this.emitter.emit(e.ReplayerEvents.Resize, { width: a.width, height: a.height }); break; case e.IncrementalSource.Input: if (-1 === a.id) break; if (n) { this.treeIndex.input(a); break } this.applyInput(a); break; case e.IncrementalSource.MediaInteraction: if (!(y = D.getNode(a.id))) return this.debugNodeNotFound(a, a.id); var u = y; try { a.type === C.Pause && u.pause(), a.type === C.Play && (u.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA ? u.play() : u.addEventListener("canplay", (function () { u.play() }))) } catch (e) { this.config.showWarning && console.warn("Failed to replay media interactions: " + (e.message || e)) } break; case e.IncrementalSource.StyleSheetRule: if (!(y = D.getNode(a.id))) return this.debugNodeNotFound(a, a.id); var d = y, p = y.parentNode, f = this.fragmentParentMap.has(p), h = void 0; if (f) { var v = this.fragmentParentMap.get(y.parentNode); h = document.createTextNode(""), p.replaceChild(h, y), v.appendChild(y) } var m = d.sheet; a.adds && a.adds.forEach((function (e) { var t = e.rule, n = e.index, r = void 0 === n ? void 0 : Math.min(n, m.rules.length); try { m.insertRule(t, r) } catch (e) { } })), a.removes && a.removes.forEach((function (e) { var t = e.index; try { m.deleteRule(t) } catch (e) { } })), f && h && p.replaceChild(y, h); break; case e.IncrementalSource.CanvasMutation: if (!this.config.UNSAFE_replayCanvas) return; var y; if (!(y = D.getNode(a.id))) return this.debugNodeNotFound(a, a.id); try { var g = y.getContext("2d"); if (a.setter) return void (g[a.property] = a.args[0]); var b = g[a.property]; if ("drawImage" === a.property && "string" == typeof a.args[0]) { var S = this.imageMap.get(t); a.args[0] = S, b.apply(g, a.args) } else b.apply(g, a.args) } catch (e) { this.warnCanvasMutationFailed(a, a.id, e) } break; case e.IncrementalSource.Font: try { var E = new FontFace(a.family, a.buffer ? new Uint8Array(JSON.parse(a.fontSource)) : a.fontSource, a.descriptors); null === (o = this.iframe.contentDocument) || void 0 === o || o.fonts.add(E) } catch (e) { this.config.showWarning && console.warn(e) } } }, a.prototype.applyMutation = function (e, t) { var o, i, a = this; e.removes.forEach((function (t) { var n = D.getNode(t.id); if (!n) return a.warnNodeNotFound(e, t.id); var r = D.getNode(t.parentId); if (!r) return a.warnNodeNotFound(e, t.parentId); if (D.removeNodeFromMap(n), r) { var o = a.fragmentParentMap.get(r); o && o.contains(n) ? o.removeChild(n) : r.removeChild(n) } })); var s = n({}, this.legacy_missingNodeRetryMap), c = []; var l = function (e) { if (!a.iframe.contentDocument) return console.warn("Looks like your replayer has been destroyed."); var n = D.getNode(e.parentId); if (!n) return c.push(e); var r = null; if (a.iframe.contentDocument.contains ? r = a.iframe.contentDocument.contains(n) : a.iframe.contentDocument.body.contains && (r = a.iframe.contentDocument.body.contains(n)), t && r) { var o = document.createDocumentFragment(); for (D.map[e.parentId] = o, a.fragmentParentMap.set(o, n); n.firstChild;)o.appendChild(n.firstChild); n = o } var i = null, l = null; if (e.previousId && (i = D.getNode(e.previousId)), e.nextId && (l = D.getNode(e.nextId)), function (e) { var t = null; return e.nextId && (t = D.getNode(e.nextId)), null !== e.nextId && void 0 !== e.nextId && -1 !== e.nextId && !t }(e)) return c.push(e); var u = R(e.node, a.iframe.contentDocument, D.map, !0); -1 !== e.previousId && -1 !== e.nextId ? (i && i.nextSibling && i.nextSibling.parentNode ? n.insertBefore(u, i.nextSibling) : l && l.parentNode ? n.contains(l) ? n.insertBefore(u, l) : n.insertBefore(u, null) : n.appendChild(u), (e.previousId || e.nextId) && a.legacy_resolveMissingNode(s, n, u, e)) : s[e.node.id] = { node: u, mutation: e } }; e.adds.forEach((function (e) { l(e) })); for (var u = Date.now(); c.length;) { var d = Y(c); if (c.length = 0, Date.now() - u > 500) { this.warn("Timeout in the loop, please check the resolve tree data:", d); break } try { for (var p = (o = void 0, r(d)), f = p.next(); !f.done; f = p.next()) { var h = f.value; D.getNode(h.value.parentId) ? q(h, (function (e) { l(e) })) : this.debug("Drop resolve tree since there is no parent for the root node.", h) } } catch (e) { o = { error: e } } finally { try { f && !f.done && (i = p.return) && i.call(p) } finally { if (o) throw o.error } } } Object.keys(s).length && Object.assign(this.legacy_missingNodeRetryMap, s), e.texts.forEach((function (t) { var n = D.getNode(t.id); if (!n) return a.warnNodeNotFound(e, t.id); a.fragmentParentMap.has(n) && (n = a.fragmentParentMap.get(n)), n.textContent = t.value })), e.attributes.forEach((function (t) { var n = D.getNode(t.id); if (!n) return a.warnNodeNotFound(e, t.id); for (var r in a.fragmentParentMap.has(n) && (n = a.fragmentParentMap.get(n)), t.attributes) if ("string" == typeof r) { var o = t.attributes[r]; try { null !== o ? n.setAttribute(r, o) : n.removeAttribute(r) } catch (e) { a.config.showWarning && console.warn("An error occurred may due to the checkout feature.", e) } } })) }, a.prototype.applyScroll = function (e) { var t = D.getNode(e.id); if (!t) return this.debugNodeNotFound(e, e.id); if (t === this.iframe.contentDocument) this.iframe.contentWindow.scrollTo({ top: e.y, left: e.x, behavior: "smooth" }); else try { t.scrollTop = e.y, t.scrollLeft = e.x } catch (e) { } }, a.prototype.applyInput = function (e) { var t = D.getNode(e.id); if (!t) return this.debugNodeNotFound(e, e.id); try { t.checked = e.isChecked, t.value = e.text } catch (e) { } }, a.prototype.legacy_resolveMissingNode = function (e, t, n, r) { var o = r.previousId, i = r.nextId, a = o && e[o], s = i && e[i]; if (a) { var c = a, l = c.node, u = c.mutation; t.insertBefore(l, n), delete e[u.node.id], delete this.legacy_missingNodeRetryMap[u.node.id], (u.previousId || u.nextId) && this.legacy_resolveMissingNode(e, t, l, u) } if (s) { var d = s; l = d.node, u = d.mutation; t.insertBefore(l, n.nextSibling), delete e[u.node.id], delete this.legacy_missingNodeRetryMap[u.node.id], (u.previousId || u.nextId) && this.legacy_resolveMissingNode(e, t, l, u) } }, a.prototype.moveAndHover = function (e, t, n, r) { this.mouse.style.left = t + "px", this.mouse.style.top = n + "px", this.drawMouseTail({ x: t, y: n }); var o = D.getNode(r); if (!o) return this.debugNodeNotFound(e, r); this.hoverElements(o) }, a.prototype.drawMouseTail = function (e) { var t = this; if (this.mouseTail) { var n = !0 === this.config.mouseTail ? Ne : Object.assign({}, Ne, this.config.mouseTail), r = n.lineCap, o = n.lineWidth, i = n.strokeStyle, a = n.duration, s = function () { if (t.mouseTail) { var e = t.mouseTail.getContext("2d"); e && t.tailPositions.length && (e.clearRect(0, 0, t.mouseTail.width, t.mouseTail.height), e.beginPath(), e.lineWidth = o, e.lineCap = r, e.strokeStyle = i, e.moveTo(t.tailPositions[0].x, t.tailPositions[0].y), t.tailPositions.forEach((function (t) { return e.lineTo(t.x, t.y) })), e.stroke()) } }; this.tailPositions.push(e), s(), setTimeout((function () { t.tailPositions = t.tailPositions.filter((function (t) { return t !== e })), s() }), a) } }, a.prototype.hoverElements = function (e) { var t; null === (t = this.iframe.contentDocument) || void 0 === t || t.querySelectorAll(".\\:hover").forEach((function (e) { e.classList.remove(":hover") })); for (var n = e; n;)n.classList && n.classList.add(":hover"), n = n.parentElement }, a.prototype.isUserInteraction = function (t) { return t.type === e.EventType.IncrementalSnapshot && (t.data.source > e.IncrementalSource.Mutation && t.data.source <= e.IncrementalSource.Input) }, a.prototype.backToNormal = function () { this.nextUserInteractionEvent = null, this.speedService.state.matches("normal") || (this.speedService.send({ type: "BACK_TO_NORMAL" }), this.emitter.emit(e.ReplayerEvents.SkipEnd, { speed: this.speedService.state.context.normalSpeed })) }, a.prototype.warnNodeNotFound = function (e, t) { this.warn("Node with id '" + t + "' not found in", e) }, a.prototype.warnCanvasMutationFailed = function (e, t, n) { this.warn("Has error on update canvas '" + t + "'", e, n) }, a.prototype.debugNodeNotFound = function (e, t) { this.debug("[replayer]", "Node with id '" + t + "' not found in", e) }, a.prototype.warn = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; this.config.showWarning && console.warn.apply(console, i(["[replayer]"], e)) }, a.prototype.debug = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; this.config.showDebug && console.log.apply(console, i(["[replayer]"], e)) }, a }(), ke = le.addCustomEvent, Re = le.freezePage; return e.Replayer = _e, e.addCustomEvent = ke, e.freezePage = Re, e.mirror = D, e.record = le, e.utils = G, Object.defineProperty(e, "__esModule", { value: !0 }), e
}({});
//# sourceMappingURL=rrweb.min.js.map